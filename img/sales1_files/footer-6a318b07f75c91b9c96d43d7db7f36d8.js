var RzPromoViewedGoods_class=new Class({options:{url:"",containerId:"promopage-block-viewed"},_storageGoodsIds:[],initialize:function(b){this.setOptions(b);this._prepareGoodsIds();if(0==this._storageGoodsIds.length)return!1;this._getGoodsData();return this},_prepareGoodsIds:function(){var b=[];Object.keys(localStorage).each(function(a){a.startsWith("goods_id_")&&(a=JSON.parse(localStorage[a]),b.push({id:parseInt(a.id),viewed:parseInt(a.viewed)}))});b.sort(function(a,b){return a.viewed-b.viewed});
this._storageGoodsIds=b.map(function(a){return a.id})},_getGoodsData:function(){var b=this._storageGoodsIds,a=this;(new Ajax(this.options.url,{data:{goods_data:b},onComplete:function(){$(a.options.containerId).setHTML(this.response.text);b.each(function(a){void 0!=document.getElementById("catalog_item"+a)&&GoodsCatalog.add(a,"search")})}})).request();return!1}});RzPromoViewedGoods_class.implement(new Options);
